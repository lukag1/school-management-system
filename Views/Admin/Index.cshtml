@model projekatPPP.Models.ViewModels.AdminDashboardViewModel

@{
    ViewData["Title"] = "Admin Dashboard";
}

<h1>Admin Dashboard</h1>

<div class="mb-3">
    <a asp-action="DodeliZaduzenje" class="btn btn-info me-2">Upravljaj zaduženjima</a>
    <a asp-action="Izvestaji" class="btn btn-secondary me-2">Sistemski izveštaji</a>
</div>

@if (TempData["Message"] != null)
{
    <div class="alert alert-success alert-dismissible fade show" role="alert">
        @TempData["Message"]
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>
}
@if (TempData["Warning"] != null)
{
    <div class="alert alert-warning alert-dismissible fade show" role="alert">
        @TempData["Warning"]
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>
}
@if (TempData["Info"] != null)
{
    <div class="alert alert-info alert-dismissible fade show" role="alert">
        @TempData["Info"]
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>
}
@if (TempData["Error"] != null)
{
    <div class="alert alert-danger alert-dismissible fade show" role="alert">
        @TempData["Error"]
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>
}

<hr />

<div class="row">
    <div class="col-md-12 mb-4">
        <h3>Korisnici</h3>
        <a asp-action="CreateUser" class="btn btn-sm btn-success mb-2">Dodaj novog korisnika</a>
        <table class="table table-striped table-bordered">
            <thead>
                <tr>
                    <th>Ime i Prezime</th>
                    <th>Email</th>
                    <th>Uloga</th>
                    <th>Status</th>
                    <th>Akcije</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var user in Model.Users)
                {
                    <tr>
                        <td>@user.Ime @user.Prezime</td>
                        <td>@user.Email</td>
                        <td>@user.Uloga</td>
                        <td>
                            @if (user.IsApproved)
                            {
                                <span class="badge bg-success">Odobren</span>
                            }
                            else
                            {
                                <span class="badge bg-warning">Čeka odobrenje</span>
                            }
                        </td>
                        <td>
                            <a asp-action="EditUser" asp-route-id="@user.Id" class="btn btn-sm btn-primary">Izmeni</a>
                            @if (!user.IsApproved)
                            {
                                <form asp-action="ApproveUser" asp-route-id="@user.Id" method="post" class="d-inline">
                                    <button type="submit" class="btn btn-sm btn-success">Odobri</button>
                                </form>
                            }
                            <form asp-action="DeleteUser" asp-route-id="@user.Id" method="post" class="d-inline">
                                <button type="submit" class="btn btn-sm btn-danger" onclick="return confirm('Da li ste sigurni da želite da obrišete ovog korisnika?');">Obriši</button>
                            </form>
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    </div>

    <div class="col-md-6">
        <h3>Predmeti</h3>
        <a asp-action="CreatePredmet" class="btn btn-sm btn-success mb-2">Dodaj novi predmet</a>
        <table class="table table-sm">
            <tbody>
                @foreach (var predmet in Model.Predmeti)
                {
                    <tr>
                        <td>@predmet.Naziv</td>
                        <td class="text-end">
                            <a asp-action="EditPredmet" asp-route-id="@predmet.Id" class="btn btn-sm btn-primary">Izmeni</a>
                            <form asp-action="DeletePredmet" asp-route-id="@predmet.Id" method="post" class="d-inline">
                                <button type="submit" class="btn btn-sm btn-danger" onclick="return confirm('Da li ste sigurni?');">Obriši</button>
                            </form>
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    </div>

    <div class="col-md-6">
        <h3>Odeljenja</h3>
        <a asp-action="CreateOdeljenje" class="btn btn-sm btn-success mb-2">Dodaj novo odeljenje</a>
        <table class="table table-sm">
            <tbody>
                @foreach (var odeljenje in Model.Odeljenja)
                {
                    <tr>
                        <td>@odeljenje.Naziv</td>
                        <td class="text-end">
                            <a asp-action="EditOdeljenje" asp-route-id="@odeljenje.Id" class="btn btn-sm btn-primary">Izmeni</a>
                            <form asp-action="DeleteOdeljenje" asp-route-id="@odeljenje.Id" method="post" class="d-inline">
                                <button type="submit" class="btn btn-sm btn-danger" onclick="return confirm('Da li ste sigurni?');">Obriši</button>
                            </form>
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
</div>